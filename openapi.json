{"openapi":"3.1.0","info":{"title":"AI Agent Backend","description":"Production-ready AI agent with dynamic MCP tools","version":"0.1.0"},"paths":{"/health":{"get":{"summary":"Health Check","description":"Health check endpoint with detailed component status.\n\nReturns overall health status and individual component health.\nStatus is 'degraded' if some MCP servers are unavailable.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/v1/chat":{"post":{"summary":"Chat Endpoint","description":"Chat endpoint with streaming support and tool calling.\n\nIMPORTANT: This implements the strict single-tool stepper pattern.\n- Tool calls are executed internally\n- Only final answers are streamed to the client\n- Thinking traces are captured but NOT streamed","operationId":"chat_endpoint_v1_chat_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/voice-turn":{"post":{"summary":"Voice Turn Endpoint","description":"Turn-based voice endpoint that handles audio transcription, agent reasoning,\nand optional TTS synthesis.","operationId":"voice_turn_endpoint_v1_voice_turn_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VoiceTurnRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VoiceTurnResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/ingest":{"post":{"summary":"Ingest Endpoint","description":"Document ingestion endpoint.\n\nAccepts local paths or URLs, parses with Docling, and upserts to Qdrant.","operationId":"ingest_endpoint_v1_ingest_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IngestRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/ingest/upload":{"post":{"summary":"Ingest Upload Endpoint","description":"Upload files, save them to a fixed directory, and ingest them.\n\nFiles are stored under a per-request folder inside `settings.ingest_upload_root`.\n\nNote: Rate limiting for file uploads should be configured at the reverse proxy level\ndue to compatibility issues with multipart/form-data endpoints.","operationId":"ingest_upload_endpoint_v1_ingest_upload_post","parameters":[{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_ingest_upload_endpoint_v1_ingest_upload_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/sessions":{"get":{"summary":"List Sessions","description":"List user's chat sessions.","operationId":"list_sessions_v1_sessions_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/sessions/{session_id}":{"get":{"summary":"Get Session","description":"Get a specific chat session with all messages.","operationId":"get_session_v1_sessions__session_id__get","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"integer","title":"Session Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"summary":"Delete Session Endpoint","description":"Delete a chat session and all its messages.","operationId":"delete_session_endpoint_v1_sessions__session_id__delete","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"integer","title":"Session Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"summary":"Update Session","description":"Update a chat session's title.","operationId":"update_session_v1_sessions__session_id__patch","parameters":[{"name":"session_id","in":"path","required":true,"schema":{"type":"integer","title":"Session Id"}},{"name":"title","in":"query","required":true,"schema":{"type":"string","title":"Title"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/documents":{"get":{"summary":"List Documents","description":"List ingested documents.","operationId":"list_documents_v1_documents_get","parameters":[{"name":"collection","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Collection"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/documents/{document_id}":{"delete":{"summary":"Delete Document Endpoint","description":"Delete a document from the catalog.\n\nNote: This only removes the metadata. Vector data in Qdrant must be deleted separately.","operationId":"delete_document_endpoint_v1_documents__document_id__delete","parameters":[{"name":"document_id","in":"path","required":true,"schema":{"type":"integer","title":"Document Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/ingestion-runs":{"get":{"summary":"List Ingestion Runs","description":"List ingestion run history.","operationId":"list_ingestion_runs_v1_ingestion_runs_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/ingestion-runs/{run_id}":{"delete":{"summary":"Delete Ingestion Run Endpoint","description":"Delete an ingestion run record.","operationId":"delete_ingestion_run_endpoint_v1_ingestion_runs__run_id__delete","parameters":[{"name":"run_id","in":"path","required":true,"schema":{"type":"integer","title":"Run Id"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v1/tool-runs":{"get":{"summary":"List Tool Runs","description":"List tool execution logs.","operationId":"list_tool_runs_v1_tool_runs_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Offset"}},{"name":"x-api-key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"Body_ingest_upload_endpoint_v1_ingest_upload_post":{"properties":{"files":{"items":{"type":"string","format":"binary"},"type":"array","title":"Files"},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"}},"type":"object","required":["files"],"title":"Body_ingest_upload_endpoint_v1_ingest_upload_post"},"ChatRequest":{"properties":{"messages":{"items":{"additionalProperties":{"type":"string"},"type":"object"},"type":"array","title":"Messages"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"stream":{"type":"boolean","title":"Stream","default":true},"enable_tools":{"type":"boolean","title":"Enable Tools","default":true},"model":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model"}},"type":"object","required":["messages"],"title":"ChatRequest","description":"Chat request model."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IngestRequest":{"properties":{"path_or_url":{"type":"string","title":"Path Or Url"},"from_web":{"type":"boolean","title":"From Web","default":false},"recursive":{"type":"boolean","title":"Recursive","default":false},"tags":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Tags"},"use_examples_dir":{"type":"boolean","title":"Use Examples Dir","default":false}},"type":"object","required":["path_or_url"],"title":"IngestRequest","description":"Ingestion request model."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VoiceTurnRequest":{"properties":{"messages":{"items":{"additionalProperties":{"type":"string"},"type":"object"},"type":"array","title":"Messages"},"audio_b64":{"type":"string","title":"Audio B64"},"sample_rate":{"type":"integer","maximum":48000.0,"minimum":8000.0,"title":"Sample Rate","default":16000},"expect_audio":{"type":"boolean","title":"Expect Audio","default":true},"enable_tools":{"type":"boolean","title":"Enable Tools","default":true},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"model":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model"}},"type":"object","required":["messages","audio_b64"],"title":"VoiceTurnRequest","description":"Turn-based voice interaction request."},"VoiceTurnResponse":{"properties":{"transcript":{"type":"string","title":"Transcript"},"assistant_text":{"type":"string","title":"Assistant Text"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata"},"audio_b64":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Audio B64"},"audio_sample_rate":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Audio Sample Rate"},"stt_confidence":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Stt Confidence"},"stt_language":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stt Language"},"tool_events":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Tool Events"},"logs":{"items":{"additionalProperties":{"type":"string"},"type":"object"},"type":"array","title":"Logs"}},"type":"object","required":["transcript","assistant_text","metadata"],"title":"VoiceTurnResponse","description":"Voice turn response payload."}}}}